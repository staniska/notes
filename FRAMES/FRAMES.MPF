;Создаем переменную для хранения фрейма
DEF FRAME FRAME_1
;Задаем смещение в наш фрейм
FRAME_1=CTRANS(X,15,Y,10,Z,20)
;Присвайваем базовому смещению значения нашего фрейма
;Это можно делать через $P_UBFR или через $P_CHBFR[0]
$P_UBFR=FRAME_1
;Вызываем G500 чтобы изменения вступили в силу.
;Можно вызвать G54 или любое другое смещение.
G500
M0
;Применяем STOPRE чтобы станок не проводил расчеты наперед 
; и можно было посмотреть в таблицах изменения
STOPRE
;Читать значения базы можно через переменную $P_UBFR
;Первый аргумент - имя оси
;Второй - тип значения: TR - смещение, RT - поворот и т.д.
;Вывод сообщения
MSG("G500 trans Z "<<$P_UBFR[Z,TR])
M0
;Очистка сообщения
MSG()
STOPRE
;Зададим значения для G54
$P_UIFR[1]=CTRANS(X,20,Y,16,Z,18):CROT(Z,45)
G54
M0
STOPRE
;Теперь можем его прочитать через переменную $P_UIFR
MSG("G54 trans X "<<$P_UIFR[1,X,TR])
M0
;можно вместо 1 поставить $P_UIFRNUM - номер активного фрейма
MSG("G54 rot Z "<<$P_UIFR[$P_UIFRNUM,Z,RT])
M0
;Можно посмотреть суммарное смещение базы и активного фрейма
MSG("G500 + G54 trans Z "<<$P_ACTFRAME[Z,TR])
M0
STOPRE
;Программируемый фрейм
TRANS Z30
;Его можно посмотреть в переменной $P_PFRAME
MSG(""<<$P_PFRAME[Z,TR])
M0

;Теперь перемещения
T="CUTTER 4" D1 M6
G0 Z0
M0
;Покадровое отключение программируемого фрейма и G54(55 и т.д.)
G53 G0 Z0
M0
;Покадровое отключение еще и G500
;SUPA отключает еще и смещение DRF. Обычно я использую его, для наглядности, вместо G153
G153 G0 Z0
M0
;Движение с учетом длины инструмента
SUPA G0 Z=0-$P_TOOLL[1]
M0

STOPRE
;Очистим базу
$P_CHBFR[0]=CTRANS()
;и G54
$P_UIFR[1]=CROT()
G54

M30